{"id":0,"registry":{"0":{"submorphs":[{"__isSmartRef__":true,"id":1}],"scripts":[],"id":1439,"shape":{"__isSmartRef__":true,"id":21},"droppingEnabled":true,"halosEnabled":true,"registeredForMouseEvents":true,"_Position":{"__isSmartRef__":true,"id":27},"showsHalos":false,"name":"DatabaseContainer","partsBinMetaInfo":{"__isSmartRef__":true,"id":28},"__SourceModuleName__":"Global.lively.morphic.Core","_Rotation":0,"_Scale":0.9980010000000026,"attributeConnections":[],"priorExtent":{"__isSmartRef__":true,"id":29},"connections":["dbURL","dbName"],"doNotSerialize":[],"doNotCopyProperties":[],"isDBContainer":true,"attributeMap":{"__isSmartRef__":true,"id":30},"dbURL":"","dbName":"","renderContextTable":{"__isSmartRef__":true,"id":31},"eventHandler":{"__isSmartRef__":true,"id":32},"__serializedLivelyClosures__":{"__isSmartRef__":true,"id":33},"__LivelyClassName__":"lively.morphic.Box"},"1":{"submorphs":[],"scripts":[],"id":1440,"shape":{"__isSmartRef__":true,"id":2},"grabbingEnabled":false,"droppingEnabled":false,"halosEnabled":true,"fixedWidth":false,"fixedHeight":true,"allowsInput":true,"_OverflowMode":"visible","_FontFamily":"Arial, sans-serif","registeredForMouseEvents":true,"_Position":{"__isSmartRef__":true,"id":7},"_MaxTextWidth":null,"_MaxTextHeight":37,"textColor":{"__isSmartRef__":true,"id":5},"showsHalos":false,"_FontSize":24,"__SourceModuleName__":"Global.lively.morphic.TextCore","_Rotation":0,"name":"Text1","partsBinMetaInfo":{"__isSmartRef__":true,"id":8},"textChunks":[{"__isSmartRef__":true,"id":9}],"charsReplaced":"some text","lastFindLoc":-9,"priorSelectionRange":[0,2],"prevScroll":[0,0],"_Scale":1.002003004005006,"owner":{"__isSmartRef__":true,"id":0},"priorExtent":{"__isSmartRef__":true,"id":11},"attributeConnections":[{"__isSmartRef__":true,"id":12},{"__isSmartRef__":true,"id":14},{"__isSmartRef__":true,"id":16}],"doNotSerialize":["$$textString"],"doNotCopyProperties":["$$textString"],"isLabel":true,"_ClipMode":"hidden","_WhiteSpaceHandling":"pre","allowInput":false,"eventsAreIgnored":true,"_TextColor":{"__isSmartRef__":true,"id":18},"renderContextTable":{"__isSmartRef__":true,"id":19},"textString":"DB","eventHandler":{"__isSmartRef__":true,"id":20},"_HandStyle":"default","_PointerEvents":"none","__LivelyClassName__":"lively.morphic.Text"},"2":{"fill":null,"__SourceModuleName__":"Global.lively.morphic.Shapes","_Position":{"__isSmartRef__":true,"id":3},"_Extent":{"__isSmartRef__":true,"id":4},"_BorderWidth":0,"_BorderColor":{"__isSmartRef__":true,"id":5},"_BorderRadius":0,"_Fill":null,"renderContextTable":{"__isSmartRef__":true,"id":6},"__LivelyClassName__":"lively.morphic.Shapes.Rectangle"},"3":{"x":0,"y":0,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"4":{"x":45,"y":37,"__LivelyClassName__":"Point","__SourceModuleName__":"Global"},"5":{"r":0,"g":0,"b":0,"a":1,"__SourceModuleName__":"Global","__LivelyClassName__":"Color"},"6":{"init":"initHTML","appendShape":"renderHTML","setPosition":"setPositionHTML","setExtent":"setExtentHTML","setFill":"setFillHTML","setBorderColor":"setBorderColorHTML","setBorderWidth":"setBorderWidthHTML","setStrokeOpacity":"setStrokeOpacityHTML","setBorderRadius":"setBorderRadiusHTML","setBorderStyle":"setBorderStyleHTML","setOpacity":"setOpacityHTML"},"7":{"x":12.026039052065244,"y":18.03605407209018,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"8":{"partsSpaceName":"PartsBin/NewWorld","__SourceModuleName__":"Global.lively.PartsBin","migrationLevel":1,"__LivelyClassName__":"lively.PartsBin.PartsBinMetaInfo"},"9":{"style":{"__isSmartRef__":true,"id":10},"chunkOwner":{"__isSmartRef__":true,"id":1},"storedString":"DB","__LivelyClassName__":"lively.morphic.TextChunk","__SourceModuleName__":"Global.lively.morphic.TextCore"},"10":{"__LivelyClassName__":"lively.morphic.TextEmphasis","__SourceModuleName__":"Global.lively.morphic.TextCore"},"11":{"x":45,"y":37,"__LivelyClassName__":"Point","__SourceModuleName__":"Global"},"12":{"sourceObj":{"__isSmartRef__":true,"id":1},"sourceAttrName":"textString","targetObj":{"__isSmartRef__":true,"id":13},"targetMethodName":"update","__SourceModuleName__":"Global.lively.bindings","__LivelyClassName__":"AttributeConnection"},"13":{"update":"DB"},"14":{"sourceObj":{"__isSmartRef__":true,"id":1},"sourceAttrName":"textString","targetObj":{"__isSmartRef__":true,"id":15},"targetMethodName":"update","__SourceModuleName__":"Global.lively.bindings","__LivelyClassName__":"AttributeConnection"},"15":{"update":"DB"},"16":{"sourceObj":{"__isSmartRef__":true,"id":1},"sourceAttrName":"textString","targetObj":{"__isSmartRef__":true,"id":17},"targetMethodName":"update","__SourceModuleName__":"Global.lively.bindings","__LivelyClassName__":"AttributeConnection"},"17":{"update":"DB"},"18":{"r":0.7,"g":0.7,"b":0.7,"a":1,"__SourceModuleName__":"Global","__LivelyClassName__":"Color"},"19":{"replaceRenderContext":"replaceRenderContextHTML","init":"initHTML","append":"appendHTML","remove":"removeHTML","triggerEvent":"triggerEventHTML","setPosition":"setPositionHTML","setRotation":"setRotationHTML","setExtent":"setExtentHTML","setScale":"setScaleHTML","setVisible":"setVisibleHTML","setOrigin":"setOriginHTML","setClipMode":"setClipModeHTML","setHandStyle":"setHandStyleHTML","setPointerEvents":"setPointerEventsHTML","updateText":"updateTextHTML","setTextExtent":"setTextExtentHTML","setMaxTextWidth":"setMaxTextWidthHTML","setMaxTextHeight":"setMaxTextHeightHTML","getTextExtent":"getTextExtentHTML","getTextString":"getTextStringHTML","ignoreTextEvents":"ignoreTextEventsHTML","enableTextEvents":"enableTextEventsHTML","setFontFamily":"setFontFamilyHTML","setFontSize":"setFontSizeHTML","setTextColor":"setTextColorHTML","setPadding":"setPaddingHTML","setAlign":"setAlignHTML","setVerticalAlign":"setVerticalAlignHTML","setDisplay":"setDisplayHTML","setWhiteSpaceHandling":"setWhiteSpaceHandlingHTML"},"20":{"morph":{"__isSmartRef__":true,"id":1},"__LivelyClassName__":"lively.morphic.EventHandler","__SourceModuleName__":"Global.lively.morphic.Events"},"21":{"position":{"__isSmartRef__":true,"id":22},"_Extent":{"__isSmartRef__":true,"id":23},"_BorderWidth":1,"_BorderColor":{"__isSmartRef__":true,"id":24},"_Fill":{"__isSmartRef__":true,"id":25},"__SourceModuleName__":"Global.lively.morphic.Shapes","_BorderRadius":10,"renderContextTable":{"__isSmartRef__":true,"id":26},"__LivelyClassName__":"lively.morphic.Shapes.Rectangle"},"22":{"x":0,"y":0,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"23":{"x":70,"y":70,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"24":{"r":0.572,"g":0.572,"b":0.572,"a":1,"__SourceModuleName__":"Global","__LivelyClassName__":"Color"},"25":{"r":0.839,"g":0.839,"b":0.839,"a":1,"__LivelyClassName__":"Color","__SourceModuleName__":"Global"},"26":{"init":"initHTML","appendShape":"renderHTML","setPosition":"setPositionHTML","setExtent":"setExtentHTML","setFill":"setFillHTML","setBorderColor":"setBorderColorHTML","setBorderWidth":"setBorderWidthHTML","setStrokeOpacity":"setStrokeOpacityHTML","setBorderRadius":"setBorderRadiusHTML","setBorderStyle":"setBorderStyleHTML","setOpacity":"setOpacityHTML"},"27":{"x":0,"y":0,"__LivelyClassName__":"Point","__SourceModuleName__":"Global"},"28":{"partsSpaceName":"PartsBin/Database/","__SourceModuleName__":"Global.lively.PartsBin","comment":"DB container. Can save attributes from objects in the world to a database.","migrationLevel":2,"requiredModules":["apps.CouchDB"],"partName":"DatabaseContainer","__LivelyClassName__":"lively.PartsBin.PartsBinMetaInfo"},"29":{"x":60,"y":60,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"30":{},"31":{"replaceRenderContext":"replaceRenderContextHTML","init":"initHTML","append":"appendHTML","remove":"removeHTML","triggerEvent":"triggerEventHTML","setPosition":"setPositionHTML","setRotation":"setRotationHTML","setExtent":"setExtentHTML","setScale":"setScaleHTML","setVisible":"setVisibleHTML","setOrigin":"setOriginHTML","setClipMode":"setClipModeHTML","setHandStyle":"setHandStyleHTML","setPointerEvents":"setPointerEventsHTML"},"32":{"morph":{"__isSmartRef__":true,"id":0},"__LivelyClassName__":"lively.morphic.EventHandler","__SourceModuleName__":"Global.lively.morphic.Events"},"33":{"saveObject":{"__isSmartRef__":true,"id":34},"onstore":{"__isSmartRef__":true,"id":37}},"34":{"varMapping":{"__isSmartRef__":true,"id":35},"source":"function saveObject() {\n\talertOK('Saving form inputs to DB...');\n\n\tvar db = new CouchDB(this.dbName);\n\tvar formObj = {};\n\n\tvar attrs = Properties.own(this.attributeMap);\n\tattrs.each(function(attr) {\n\t\tvar data = this.attributeMap[attr];\n\t\tvar srcObj = data[0];\n\t\tvar srcAttr = data[1];\n\t\tif (srcObj && (srcObj.owner) && (srcObj[srcAttr] != undefined))\n\t\t\tformObj[attr] = srcObj[srcAttr];\n\t}, this);\n\n\tres = db.save(formObj);\n\n\tif (res.error)\n\t\talert('Problem saving: ' + res.reason + ' (' + res.error + ')!');\n\telse\n\t\talertOK('Saving was successful!');\n}","funcProperties":{"__isSmartRef__":true,"id":36},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"35":{"this":{"__isSmartRef__":true,"id":0}},"36":{},"37":{"varMapping":{"__isSmartRef__":true,"id":38},"source":"function onstore() {\n\tvar attrs = Properties.own(this.attributeMap);\n\tattrs.each(function(attr) {\n\t\tvar data = this.attributeMap[attr];\n\t\tvar srcObj = data[0];\n\t\tif (!srcObj || !(srcObj.owner))\n\t\t\tdelete this.attributeMap[attr];\n\t}, this);\n\n\treturn $super();\n}","funcProperties":{"__isSmartRef__":true,"id":43},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"38":{"this":{"__isSmartRef__":true,"id":0},"__serializedLivelyClosures__":{"__isSmartRef__":true,"id":39}},"39":{"$super":{"__isSmartRef__":true,"id":40}},"40":{"varMapping":{"__isSmartRef__":true,"id":41},"source":"function () {\n\t\t\t\ttry {\n\t\t\t\t\treturn obj.constructor.prototype[name].apply(obj, arguments)\n\t\t\t\t} catch(e) {\n\t\t\t\t\talert('Error in $super call: ' + e + '\\n' + e.stack);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}","funcProperties":{"__isSmartRef__":true,"id":42},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"41":{"obj":{"__isSmartRef__":true,"id":0},"name":"onstore"},"42":{},"43":{},"isSimplifiedRegistry":true}}