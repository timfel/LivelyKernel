{"id":0,"registry":{"0":{"submorphs":[{"__isSmartRef__":true,"id":1},{"__isSmartRef__":true,"id":15}],"scripts":[],"id":"A1A557B4-EF66-4138-A355-8E33D1D5301A","shape":{"__isSmartRef__":true,"id":30},"droppingEnabled":true,"halosEnabled":true,"registeredForMouseEvents":true,"_Position":{"__isSmartRef__":true,"id":36},"showsHalos":false,"name":"DatabaseConnector","partsBinMetaInfo":{"__isSmartRef__":true,"id":37},"__SourceModuleName__":"Global.lively.morphic.Core","renderContextTable":{"__isSmartRef__":true,"id":98},"eventHandler":{"__isSmartRef__":true,"id":99},"attributeConnections":[],"doNotSerialize":[],"doNotCopyProperties":[],"layout":{"__isSmartRef__":true,"id":100},"priorExtent":{"__isSmartRef__":true,"id":101},"isBeingDragged":false,"eventsAreIgnored":false,"dbQueryPostRoute":"evaljs","eventsAreDisabled":false,"_HandStyle":"default","_PointerEvents":"auto","isDatabaseConnector":true,"prevScroll":[0,0],"distanceToDragEvent":{"__isSmartRef__":true,"id":102},"derivationIds":[2361,"CBF5745D-0411-448A-AB05-0C3C10BCAF6D","CA454CED-7303-487C-A187-AB7679832DBA","C9B7A181-CDA2-4830-BC97-B4AB2B590360"],"_Rotation":0,"_Scale":1.0060210561262526,"__serializedLivelyClosures__":{"__isSmartRef__":true,"id":103},"__LivelyClassName__":"lively.morphic.Box"},"1":{"submorphs":[],"scripts":[],"shape":{"__isSmartRef__":true,"id":2},"id":"C1772869-7345-41D0-B774-4C56ADAFD5A9","renderContextTable":{"__isSmartRef__":true,"id":9},"eventHandler":{"__isSmartRef__":true,"id":10},"droppingEnabled":true,"halosEnabled":true,"_Position":{"__isSmartRef__":true,"id":11},"__SourceModuleName__":"Global.lively.morphic.Core","showsHalos":false,"layout":{"__isSmartRef__":true,"id":12},"name":"Ellipse","partsBinMetaInfo":{"__isSmartRef__":true,"id":13},"attributeConnections":[],"doNotSerialize":[],"doNotCopyProperties":[],"owner":{"__isSmartRef__":true,"id":0},"isBeingDragged":false,"priorExtent":{"__isSmartRef__":true,"id":14},"eventsAreIgnored":true,"prevScroll":[0,0],"derivationIds":[2362,"D924A0EC-6DBE-415F-B6B2-F9B959964D76","2E628B16-8BA9-402A-80D1-28CD4CD028A3","E82495D2-7FBD-485B-AA6E-F26DB0976DFC"],"eventsAreDisabled":true,"_HandStyle":"default","_PointerEvents":"none","_Rotation":0,"_Scale":1,"__LivelyClassName__":"lively.morphic.Morph"},"2":{"_Position":{"__isSmartRef__":true,"id":3},"renderContextTable":{"__isSmartRef__":true,"id":4},"_Extent":{"__isSmartRef__":true,"id":5},"_ClipMode":"visible","_Padding":{"__isSmartRef__":true,"id":6},"_BorderWidth":3.184,"_BorderColor":{"__isSmartRef__":true,"id":7},"_Fill":{"__isSmartRef__":true,"id":8},"__SourceModuleName__":"Global.lively.morphic.Shapes","_BorderRadius":0,"_Opacity":1,"_BorderStyle":"solid","__LivelyClassName__":"lively.morphic.Shapes.Ellipse"},"3":{"x":-50,"y":-50,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"4":{"init":"initHTML","appendShape":"renderHTML","setPosition":"setPositionHTML","setExtent":"setExtentHTML","setPadding":"setPaddingHTML","setFill":"setFillHTML","setBorderColor":"setBorderColorHTML","setBorderWidth":"setBorderWidthHTML","setStrokeOpacity":"setStrokeOpacityHTML","setBorderRadius":"setBorderRadiusHTML","setBorderStyle":"setBorderStyleHTML","setOpacity":"setOpacityHTML","setClipMode":"setClipModeHTML"},"5":{"x":122,"y":42,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"6":{"x":0,"y":0,"width":0,"height":0,"__SourceModuleName__":"Global","__LivelyClassName__":"Rectangle"},"7":{"r":1,"g":1,"b":1,"a":1,"__SourceModuleName__":"Global","__LivelyClassName__":"Color"},"8":{"r":0,"g":0.556,"b":1,"a":1,"__LivelyClassName__":"Color","__SourceModuleName__":"Global"},"9":{"replaceRenderContext":"replaceRenderContextHTML","init":"initHTML","append":"appendHTML","remove":"removeHTML","triggerEvent":"triggerEventHTML","setTransform":"setTransformHTML","setPosition":"setPositionHTML","setRotation":"setRotationHTML","setExtent":"setExtentHTML","setScale":"setScaleHTML","setVisible":"setVisibleHTML","adjustOrigin":"adjustOriginHTML","setPivotPoint":"setPivotPointHTML","setClipMode":"setClipModeHTML","showsVerticalScrollBar":"showsVerticalScrollBarHTML","showsHorizontalScrollBar":"showsHorizontalScrollBarHTML","getScrollBarExtent":"getScrollBarExtentHTML","setHandStyle":"setHandStyleHTML","setPointerEvents":"setPointerEventsHTML","setToolTip":"setToolTipHTML","focus":"focusHTML","blur":"blurHTML","setFocusable":"setFocusableHTML"},"10":{"morph":{"__isSmartRef__":true,"id":1},"__SourceModuleName__":"Global.lively.morphic.Events","__LivelyClassName__":"lively.morphic.EventHandler"},"11":{"x":47,"y":28,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"12":{},"13":{"partName":"Ellipse","requiredModules":[],"migrationLevel":4,"partsSpaceName":"PartsBin/Basic","__SourceModuleName__":"Global.lively.PartsBin","__LivelyClassName__":"lively.PartsBin.PartsBinMetaInfo"},"14":{"x":123,"y":42,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"15":{"submorphs":[],"scripts":[],"shape":{"__isSmartRef__":true,"id":16},"id":"9D100B24-154C-4E29-AE38-A6388D4AF342","renderContextTable":{"__isSmartRef__":true,"id":23},"eventHandler":{"__isSmartRef__":true,"id":24},"droppingEnabled":true,"halosEnabled":true,"_Position":{"__isSmartRef__":true,"id":25},"__SourceModuleName__":"Global.lively.morphic.Core","showsHalos":false,"layout":{"__isSmartRef__":true,"id":26},"name":"Ellipse1","partsBinMetaInfo":{"__isSmartRef__":true,"id":27},"attributeConnections":[],"doNotSerialize":[],"doNotCopyProperties":[],"isBeingDragged":false,"priorExtent":{"__isSmartRef__":true,"id":28},"eventsAreIgnored":true,"owner":{"__isSmartRef__":true,"id":0},"distanceToDragEvent":{"__isSmartRef__":true,"id":29},"prevScroll":[0,0],"derivationIds":[2363,"2E16CC94-9491-4CAD-B6B9-95BD19C61C14","806B547A-56F3-4C55-ACB1-01A896103158","7ECE80CA-A96D-47D9-B915-DAAEAC791048"],"eventsAreDisabled":true,"_HandStyle":"default","_PointerEvents":"none","_Rotation":0,"_Scale":1,"__LivelyClassName__":"lively.morphic.Morph"},"16":{"_Position":{"__isSmartRef__":true,"id":17},"renderContextTable":{"__isSmartRef__":true,"id":18},"_Extent":{"__isSmartRef__":true,"id":19},"_ClipMode":"visible","_Padding":{"__isSmartRef__":true,"id":20},"_BorderWidth":0,"_BorderColor":{"__isSmartRef__":true,"id":21},"_Fill":{"__isSmartRef__":true,"id":22},"__SourceModuleName__":"Global.lively.morphic.Shapes","_BorderRadius":0,"_Opacity":1,"_BorderStyle":"solid","__LivelyClassName__":"lively.morphic.Shapes.Ellipse"},"17":{"x":-50,"y":-50,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"18":{"init":"initHTML","appendShape":"renderHTML","setPosition":"setPositionHTML","setExtent":"setExtentHTML","setPadding":"setPaddingHTML","setFill":"setFillHTML","setBorderColor":"setBorderColorHTML","setBorderWidth":"setBorderWidthHTML","setStrokeOpacity":"setStrokeOpacityHTML","setBorderRadius":"setBorderRadiusHTML","setBorderStyle":"setBorderStyleHTML","setOpacity":"setOpacityHTML","setClipMode":"setClipModeHTML"},"19":{"x":115,"y":41,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"20":{"x":0,"y":0,"width":0,"height":0,"__SourceModuleName__":"Global","__LivelyClassName__":"Rectangle"},"21":{"r":1,"g":1,"b":1,"a":1,"__SourceModuleName__":"Global","__LivelyClassName__":"Color"},"22":{"r":0,"g":0.556,"b":1,"a":1,"__LivelyClassName__":"Color","__SourceModuleName__":"Global"},"23":{"replaceRenderContext":"replaceRenderContextHTML","init":"initHTML","append":"appendHTML","remove":"removeHTML","triggerEvent":"triggerEventHTML","setTransform":"setTransformHTML","setPosition":"setPositionHTML","setRotation":"setRotationHTML","setExtent":"setExtentHTML","setScale":"setScaleHTML","setVisible":"setVisibleHTML","adjustOrigin":"adjustOriginHTML","setPivotPoint":"setPivotPointHTML","setClipMode":"setClipModeHTML","showsVerticalScrollBar":"showsVerticalScrollBarHTML","showsHorizontalScrollBar":"showsHorizontalScrollBarHTML","getScrollBarExtent":"getScrollBarExtentHTML","setHandStyle":"setHandStyleHTML","setPointerEvents":"setPointerEventsHTML","setToolTip":"setToolTipHTML","focus":"focusHTML","blur":"blurHTML","setFocusable":"setFocusableHTML"},"24":{"morph":{"__isSmartRef__":true,"id":15},"__SourceModuleName__":"Global.lively.morphic.Events","__LivelyClassName__":"lively.morphic.EventHandler"},"25":{"x":50.00000000000003,"y":90.00000000000006,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"26":{},"27":{"partName":"Ellipse","requiredModules":[],"migrationLevel":4,"partsSpaceName":"PartsBin/Basic","__SourceModuleName__":"Global.lively.PartsBin","__LivelyClassName__":"lively.PartsBin.PartsBinMetaInfo"},"28":{"x":116,"y":41,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"29":{"x":31.00000000000003,"y":-60.50000000000006,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"30":{"position":{"__isSmartRef__":true,"id":31},"_Extent":{"__isSmartRef__":true,"id":32},"_BorderWidth":0,"_BorderColor":{"__isSmartRef__":true,"id":7},"_Fill":{"__isSmartRef__":true,"id":33},"__SourceModuleName__":"Global.lively.morphic.Shapes","renderContextTable":{"__isSmartRef__":true,"id":34},"_ClipMode":"visible","_Padding":{"__isSmartRef__":true,"id":35},"_BorderRadius":0,"_Opacity":1,"_BorderStyle":"solid","__LivelyClassName__":"lively.morphic.Shapes.Rectangle"},"31":{"x":0,"y":0,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"32":{"x":115,"y":61,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"33":{"r":0,"g":0.556,"b":1,"a":1,"__LivelyClassName__":"Color","__SourceModuleName__":"Global"},"34":{"init":"initHTML","appendShape":"renderHTML","setPosition":"setPositionHTML","setExtent":"setExtentHTML","setPadding":"setPaddingHTML","setFill":"setFillHTML","setBorderColor":"setBorderColorHTML","setBorderWidth":"setBorderWidthHTML","setStrokeOpacity":"setStrokeOpacityHTML","setBorderRadius":"setBorderRadiusHTML","setBorderStyle":"setBorderStyleHTML","setOpacity":"setOpacityHTML","setClipMode":"setClipModeHTML"},"35":{"x":0,"y":0,"width":0,"height":0,"__SourceModuleName__":"Global","__LivelyClassName__":"Rectangle"},"36":{"x":0,"y":0,"__LivelyClassName__":"Point","__SourceModuleName__":"Global"},"37":{"partsSpaceName":"PartsBin/DatabaseDemo/","__SourceModuleName__":"Global.lively.PartsBin","comment":"This morph represents an open database connection from our Node.js server to an RDBMS. It can fetch, insert, update, and remove data rows. \nIt needs to know the database host.","migrationLevel":4,"partName":"DatabaseConnector","changes":[{"__isSmartRef__":true,"id":38},{"__isSmartRef__":true,"id":40},{"__isSmartRef__":true,"id":42},{"__isSmartRef__":true,"id":44},{"__isSmartRef__":true,"id":46},{"__isSmartRef__":true,"id":48},{"__isSmartRef__":true,"id":50},{"__isSmartRef__":true,"id":52},{"__isSmartRef__":true,"id":54},{"__isSmartRef__":true,"id":56},{"__isSmartRef__":true,"id":58},{"__isSmartRef__":true,"id":60},{"__isSmartRef__":true,"id":62},{"__isSmartRef__":true,"id":64},{"__isSmartRef__":true,"id":66},{"__isSmartRef__":true,"id":68},{"__isSmartRef__":true,"id":70},{"__isSmartRef__":true,"id":72},{"__isSmartRef__":true,"id":74},{"__isSmartRef__":true,"id":76},{"__isSmartRef__":true,"id":78},{"__isSmartRef__":true,"id":80},{"__isSmartRef__":true,"id":82},{"__isSmartRef__":true,"id":84},{"__isSmartRef__":true,"id":86},{"__isSmartRef__":true,"id":88},{"__isSmartRef__":true,"id":90},{"__isSmartRef__":true,"id":92},{"__isSmartRef__":true,"id":94},{"__isSmartRef__":true,"id":96}],"__LivelyClassName__":"lively.PartsBin.PartsBinMetaInfo"},"38":{"date":{"__isSmartRef__":true,"id":39},"author":null,"message":"","id":"2989F762-1CB3-40C5-85CD-89D8C2CDA04B"},"39":{"isSerializedDate":true,"string":"Wed Jan 04 2012 14:26:40 GMT-0800 (PST)"},"40":{"date":{"__isSmartRef__":true,"id":41},"author":null,"message":"","id":"C8549D37-35DC-4E52-9769-830DE9094477"},"41":{"isSerializedDate":true,"string":"Wed Nov 23 2011 13:50:03 GMT-0800 (PST)"},"42":{"date":{"__isSmartRef__":true,"id":43},"author":null,"message":"","id":"D45E9A1B-D147-430F-B594-BE1526AB98FA"},"43":{"isSerializedDate":true,"string":"Wed Nov 23 2011 08:25:31 GMT-0800 (PST)"},"44":{"date":{"__isSmartRef__":true,"id":45},"author":null,"message":"","id":"5FE58460-8194-45E0-8A22-C53B20262F28"},"45":{"isSerializedDate":true,"string":"Tue Nov 22 2011 14:24:47 GMT-0800 (PST)"},"46":{"date":{"__isSmartRef__":true,"id":47},"author":null,"message":"","id":"36E6B8C7-363E-407F-B376-4F2AAC1AF02C"},"47":{"isSerializedDate":true,"string":"Tue Nov 22 2011 12:40:23 GMT-0800 (PST)"},"48":{"date":{"__isSmartRef__":true,"id":49},"author":null,"message":"","id":"AAD69B14-9C97-4777-8D20-E9EC8C9E99B0"},"49":{"isSerializedDate":true,"string":"Thu Nov 17 2011 09:31:42 GMT-0800 (PST)"},"50":{"date":{"__isSmartRef__":true,"id":51},"author":null,"message":"","id":"46566742-80E0-4E60-B2DC-964F64B356C4"},"51":{"isSerializedDate":true,"string":"Mon Nov 14 2011 17:44:11 GMT-0800 (PST)"},"52":{"date":{"__isSmartRef__":true,"id":53},"author":null,"message":"","id":"6A3BE320-60A6-4264-AD49-F954D99F8A74"},"53":{"isSerializedDate":true,"string":"Mon Nov 14 2011 11:21:07 GMT-0800 (PST)"},"54":{"date":{"__isSmartRef__":true,"id":55},"author":null,"message":""},"55":{"isSerializedDate":true,"string":"Thu Oct 20 2011 13:15:44 GMT-0700 (PDT)"},"56":{"date":{"__isSmartRef__":true,"id":57},"author":"fbo","message":""},"57":{"isSerializedDate":true,"string":"Wed Oct 19 2011 17:47:02 GMT-0700 (PDT)"},"58":{"date":{"__isSmartRef__":true,"id":59},"author":"fbo","message":""},"59":{"isSerializedDate":true,"string":"Wed Oct 19 2011 17:52:29 GMT-0700 (PDT)"},"60":{"date":{"__isSmartRef__":true,"id":61},"author":"fbo","message":""},"61":{"isSerializedDate":true,"string":"Wed Oct 19 2011 18:03:15 GMT-0700 (PDT)"},"62":{"date":{"__isSmartRef__":true,"id":63},"author":null,"message":"added #addToTable(dataForm), creates the table if necessary","id":"ED23AD6A-C3A2-434E-993F-74FFE4E1D126"},"63":{"isSerializedDate":true,"string":"Mon Nov 14 2011 12:51:03 GMT-0800 (PST)"},"64":{"date":{"__isSmartRef__":true,"id":65},"author":null,"message":"","id":"FEB82BE4-DBD2-468D-89BB-FAEC7F33AADD"},"65":{"isSerializedDate":true,"string":"Mon Nov 21 2011 09:52:56 GMT-0800 (PST)"},"66":{"date":{"__isSmartRef__":true,"id":67},"author":null,"message":"","id":"760A91CC-2688-423E-BB62-FF31776D3534"},"67":{"isSerializedDate":true,"string":"Tue Nov 22 2011 13:47:07 GMT-0800 (PST)"},"68":{"date":{"__isSmartRef__":true,"id":69},"author":null,"message":"","id":"FF379119-2A49-432A-BC3E-FA0D537D89F5"},"69":{"isSerializedDate":true,"string":"Tue Nov 22 2011 14:52:18 GMT-0800 (PST)"},"70":{"date":{"__isSmartRef__":true,"id":71},"author":null,"message":"","id":"EF4884A9-0E0D-4986-BF18-B8A3CCB8D110"},"71":{"isSerializedDate":true,"string":"Tue Nov 22 2011 15:08:19 GMT-0800 (PST)"},"72":{"date":{"__isSmartRef__":true,"id":73},"author":null,"message":"","id":"E1B7EB90-1109-4CE0-BF17-A2D36D9BCC1A"},"73":{"isSerializedDate":true,"string":"Tue Nov 22 2011 15:16:51 GMT-0800 (PST)"},"74":{"date":{"__isSmartRef__":true,"id":75},"author":null,"message":"","id":"3E1FAF2D-DA54-438A-A1B7-425E6926AD62"},"75":{"isSerializedDate":true,"string":"Tue Nov 22 2011 15:21:37 GMT-0800 (PST)"},"76":{"date":{"__isSmartRef__":true,"id":77},"author":null,"message":"","id":"3C23BF19-8749-4204-AED0-032627F75AF6"},"77":{"isSerializedDate":true,"string":"Tue Nov 22 2011 15:32:36 GMT-0800 (PST)"},"78":{"date":{"__isSmartRef__":true,"id":79},"author":null,"message":"corrected a major bug Fabian unfortunately introduced","id":"FFA373DB-0C8B-4706-A302-1061BBCF934D"},"79":{"isSerializedDate":true,"string":"Tue Nov 22 2011 15:35:35 GMT-0800 (PST)"},"80":{"date":{"__isSmartRef__":true,"id":81},"author":null,"message":"","id":"F68A9BFD-CEE5-46A2-B36D-930E0A808D22"},"81":{"isSerializedDate":true,"string":"Wed Nov 23 2011 11:24:21 GMT-0800 (PST)"},"82":{"date":{"__isSmartRef__":true,"id":83},"author":null,"message":"","id":"855EF267-5CDB-4EAE-9F48-D72CBAF7047B"},"83":{"isSerializedDate":true,"string":"Wed Nov 23 2011 11:31:12 GMT-0800 (PST)"},"84":{"date":{"__isSmartRef__":true,"id":85},"author":null,"message":"","id":"7870D240-8C76-4D06-B924-F64D23D06D8E"},"85":{"isSerializedDate":true,"string":"Wed Nov 23 2011 11:57:25 GMT-0800 (PST)"},"86":{"date":{"__isSmartRef__":true,"id":87},"author":null,"message":"","id":"34579F90-C579-46ED-BBFD-DA13339BF0F4"},"87":{"isSerializedDate":true,"string":"Wed Nov 23 2011 12:46:27 GMT-0800 (PST)"},"88":{"date":{"__isSmartRef__":true,"id":89},"author":null,"message":"","id":"D164A2BA-70F9-4D3C-AE81-B79A55E9154A"},"89":{"isSerializedDate":true,"string":"Wed Nov 23 2011 13:00:59 GMT-0800 (PST)"},"90":{"date":{"__isSmartRef__":true,"id":91},"author":null,"message":"","id":"1FA67F6A-B3DD-425E-A204-FA354F6280BD"},"91":{"isSerializedDate":true,"string":"Tue Jan 03 2012 11:35:31 GMT-0800 (PST)"},"92":{"date":{"__isSmartRef__":true,"id":93},"author":null,"message":"","id":"E18F5BF0-A7D1-4D82-90B7-6F66C474AE1F"},"93":{"isSerializedDate":true,"string":"Wed Jan 04 2012 14:27:39 GMT-0800 (PST)"},"94":{"date":{"__isSmartRef__":true,"id":95},"author":"fbo","message":"","id":"3D287E55-8BC3-4128-BAB7-7A5BC90E4C86"},"95":{"isSerializedDate":true,"string":"Wed Jan 25 2012 16:05:46 GMT-0800 (PST)"},"96":{"date":{"__isSmartRef__":true,"id":97},"author":"fbo","message":"","id":"7CC08297-67C3-47EA-91CF-2CFAE42094F0"},"97":{"isSerializedDate":true,"string":"Wed Jan 25 2012 16:27:59 GMT-0800 (PST)"},"98":{"replaceRenderContext":"replaceRenderContextHTML","init":"initHTML","append":"appendHTML","remove":"removeHTML","triggerEvent":"triggerEventHTML","setTransform":"setTransformHTML","setPosition":"setPositionHTML","setRotation":"setRotationHTML","setExtent":"setExtentHTML","setScale":"setScaleHTML","setVisible":"setVisibleHTML","adjustOrigin":"adjustOriginHTML","setPivotPoint":"setPivotPointHTML","setClipMode":"setClipModeHTML","showsVerticalScrollBar":"showsVerticalScrollBarHTML","showsHorizontalScrollBar":"showsHorizontalScrollBarHTML","getScrollBarExtent":"getScrollBarExtentHTML","setHandStyle":"setHandStyleHTML","setPointerEvents":"setPointerEventsHTML","setToolTip":"setToolTipHTML","focus":"focusHTML","blur":"blurHTML","setFocusable":"setFocusableHTML"},"99":{"morph":{"__isSmartRef__":true,"id":0},"__SourceModuleName__":"Global.lively.morphic.Events","__LivelyClassName__":"lively.morphic.EventHandler"},"100":{},"101":{"x":114,"y":61,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"102":{"x":69,"y":-39,"__SourceModuleName__":"Global","__LivelyClassName__":"Point"},"103":{"createResource":{"__isSmartRef__":true,"id":104},"exec":{"__isSmartRef__":true,"id":108},"execFunction":{"__isSmartRef__":true,"id":112},"fetchAll":{"__isSmartRef__":true,"id":116},"insert":{"__isSmartRef__":true,"id":120},"setDbHost":{"__isSmartRef__":true,"id":124},"setDbQueryPostRoute":{"__isSmartRef__":true,"id":128},"update":{"__isSmartRef__":true,"id":132},"drop":{"__isSmartRef__":true,"id":136},"getDbHost":{"__isSmartRef__":true,"id":140},"dropObject":{"__isSmartRef__":true,"id":144},"addToTable":{"__isSmartRef__":true,"id":148},"getLastInsertId":{"__isSmartRef__":true,"id":152},"tableStructure":{"__isSmartRef__":true,"id":156},"createTableForForm":{"__isSmartRef__":true,"id":160},"saveObject":{"__isSmartRef__":true,"id":164},"tableExists":{"__isSmartRef__":true,"id":168},"updateCol":{"__isSmartRef__":true,"id":172},"createMetadataTables":{"__isSmartRef__":true,"id":176},"ensureFormIsPresent":{"__isSmartRef__":true,"id":180},"fetchFormForTable":{"__isSmartRef__":true,"id":184}},"104":{"varMapping":{"__isSmartRef__":true,"id":105},"source":"function createResource() {\n    var res = new WebResource('http://' + this.getDbHost() + '/' + this.dbQueryPostRoute);\n    return res;\n}","funcProperties":{"__isSmartRef__":true,"id":106},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"105":{"this":{"__isSmartRef__":true,"id":0}},"106":{"timestamp":{"__isSmartRef__":true,"id":107}},"107":{"isSerializedDate":true,"string":"Thu Oct 20 2011 13:14:51 GMT-0700 (PDT)"},"108":{"varMapping":{"__isSmartRef__":true,"id":109},"source":"function exec(sqlString) {\n    this.execFunction(\"query\", sqlString);\n}","funcProperties":{"__isSmartRef__":true,"id":110},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"109":{"this":{"__isSmartRef__":true,"id":0}},"110":{"user":"fbo","timestamp":{"__isSmartRef__":true,"id":111}},"111":{"isSerializedDate":true,"string":"Wed Oct 19 2011 17:49:22 GMT-0700 (PDT)"},"112":{"varMapping":{"__isSmartRef__":true,"id":113},"source":"function execFunction(funcName, sqlString) {\n    var res = this.createResource();\n    var retVal = res.post('function(res) { ' +\n    'db.' + funcName + '(\"' + sqlString + '\", null, function(err, r) {'+\n        'if (err) { res.send(JSON.stringify({error: err})); return; }' +\n        'res.send(JSON.stringify(r));'+\n    '});'+\n'}', 'text/javascript').content;\n    return JSON.parse(retVal);\n}","funcProperties":{"__isSmartRef__":true,"id":114},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"113":{"this":{"__isSmartRef__":true,"id":0}},"114":{"timestamp":{"__isSmartRef__":true,"id":115}},"115":{"isSerializedDate":true,"string":"Thu Oct 20 2011 20:56:19 GMT-0700 (PDT)"},"116":{"varMapping":{"__isSmartRef__":true,"id":117},"source":"function fetchAll(sqlString) {\n    return this.execFunction(\"fetchAll\", sqlString);\n}","funcProperties":{"__isSmartRef__":true,"id":118},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"117":{"this":{"__isSmartRef__":true,"id":0}},"118":{"user":"fbo","timestamp":{"__isSmartRef__":true,"id":119}},"119":{"isSerializedDate":true,"string":"Wed Oct 19 2011 17:49:37 GMT-0700 (PDT)"},"120":{"varMapping":{"__isSmartRef__":true,"id":121},"source":"function insert(tableName, object) {\n    var res = this.createResource();\n\n    var funcString = 'function(res) { db.insert(\"' + tableName + '\", JSON.parse(unescape(\"' +\n        escape(JSON.stringify(object)) + '\")), function(err) { ' +\n            'res.send(JSON.stringify({error: err, rowid: db.getLastInsertId()}));' +\n        '}' + \n    ');}';\n    return JSON.parse(res.post(funcString).content);\n}","funcProperties":{"__isSmartRef__":true,"id":122},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global"},"121":{"this":{"__isSmartRef__":true,"id":0}},"122":{"timestamp":{"__isSmartRef__":true,"id":123},"user":"fbo","tags":[]},"123":{"isSerializedDate":true,"string":"Wed Jan 25 2012 16:27:50 GMT-0800 (PST)"},"124":{"varMapping":{"__isSmartRef__":true,"id":125},"source":"function setDbHost(host) {\n    this.dbHost = host;\n}","funcProperties":{"__isSmartRef__":true,"id":126},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"125":{"this":{"__isSmartRef__":true,"id":0}},"126":{"user":"fbo","timestamp":{"__isSmartRef__":true,"id":127}},"127":{"isSerializedDate":true,"string":"Wed Oct 19 2011 17:50:00 GMT-0700 (PDT)"},"128":{"varMapping":{"__isSmartRef__":true,"id":129},"source":"function setDbQueryPostRoute(aString) {\n    this.dbQueryPostRoute = aString;\n}","funcProperties":{"__isSmartRef__":true,"id":130},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"129":{"this":{"__isSmartRef__":true,"id":0}},"130":{"user":"fbo","timestamp":{"__isSmartRef__":true,"id":131}},"131":{"isSerializedDate":true,"string":"Wed Oct 19 2011 17:50:08 GMT-0700 (PDT)"},"132":{"varMapping":{"__isSmartRef__":true,"id":133},"source":"function update(tableName, newObject, whereObject) {\n    var res = this.createResource();\n    var whereString = escape(JSON.stringify(whereObject));\n    var newDataString = escape(JSON.stringify(newObject));\n\n    var funcString = 'function(res) { ' + \n        'db.update(\"' + tableName + '\", ' +\n                'JSON.parse(unescape(\"' + newDataString + '\")), ' +\n                'JSON.parse(unescape(\"' + whereString + '\")), ' +\n                'function(err) { ' +\n                    'res.send(JSON.stringify({error: err, rowid: db.getLastInsertId()}));' +\n                '}' + \n        ');}';\n    return JSON.parse(res.post(funcString).content);\n}","funcProperties":{"__isSmartRef__":true,"id":134},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"133":{"this":{"__isSmartRef__":true,"id":0}},"134":{"timestamp":{"__isSmartRef__":true,"id":135},"user":"fbo","tags":[]},"135":{"isSerializedDate":true,"string":"Wed Jan 25 2012 16:05:37 GMT-0800 (PST)"},"136":{"varMapping":{"__isSmartRef__":true,"id":137},"source":"function drop(tableName, whereObject) {\n    var res = this.createResource();\n    var whereString = escape(JSON.stringify(whereObject));\n    var funcString = 'function(res) { ' + \n        'db.remove(\"' + tableName + '\", ' +\n                'JSON.parse(unescape(\"' + whereString + '\")), ' +\n                'function(err) { ' +\n                    'res.send(JSON.stringify({error: err}));' +\n                '}' + \n        ');}';\n    return JSON.parse(res.post(funcString).content);\n}","funcProperties":{"__isSmartRef__":true,"id":138},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"137":{"this":{"__isSmartRef__":true,"id":0}},"138":{"user":"fbo","timestamp":{"__isSmartRef__":true,"id":139}},"139":{"isSerializedDate":true,"string":"Wed Oct 19 2011 18:02:37 GMT-0700 (PDT)"},"140":{"varMapping":{"__isSmartRef__":true,"id":141},"source":"function getDbHost() {\n    if (this.dbHost) {\n        return this.dbHost;\n    } \n    // default: talk to origin\n    return Config.codeBase.match(/(http.?):\\/\\/([^\\/]*)\\/(.*)/)[2];\n}","funcProperties":{"__isSmartRef__":true,"id":142},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"141":{"this":{"__isSmartRef__":true,"id":0}},"142":{"timestamp":{"__isSmartRef__":true,"id":143}},"143":{"isSerializedDate":true,"string":"Thu Oct 20 2011 13:14:31 GMT-0700 (PDT)"},"144":{"varMapping":{"__isSmartRef__":true,"id":145},"source":"function dropObject(table, obj) {\n    var res = [];\n    if (obj.rowid) {\n        var cond = [];\n        cond.push('rowid=?');\n        cond.push(obj.rowid);\n        res.push(cond);\n    } else {\n        for (var prop in obj) {\n            var cond = [];\n            cond.push(prop + '=?');\n            cond.push(obj[prop]);\n            res.push(cond);\n        }\n    }\n    return this.drop(table, res);\n}","funcProperties":{"__isSmartRef__":true,"id":146},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"145":{"this":{"__isSmartRef__":true,"id":0}},"146":{"timestamp":{"__isSmartRef__":true,"id":147},"categories":[]},"147":{"isSerializedDate":true,"string":"Wed Nov 23 2011 13:49:54 GMT-0800 (PST)"},"148":{"varMapping":{"__isSmartRef__":true,"id":149},"source":"function addToTable(dataForm) {\n\n    if (!this.tableExists(dataForm.getTableName())) {\n        this.createTableForForm(dataForm);\n    }\n    this.saveObject(dataForm.getTableName(), dataForm.asDataObject());\n}","funcProperties":{"__isSmartRef__":true,"id":150},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"149":{"this":{"__isSmartRef__":true,"id":0}},"150":{"timestamp":{"__isSmartRef__":true,"id":151},"categories":[]},"151":{"isSerializedDate":true,"string":"Tue Nov 22 2011 15:30:27 GMT-0800 (PST)"},"152":{"varMapping":{"__isSmartRef__":true,"id":153},"source":"function getLastInsertId() {\n    var res = this.createResource();\n    var retVal = res.post('function(res) { ' +\n        'res.send(JSON.stringify(db.getLastInsertId()));' +\n    '}', 'text/javascript').content;\n    return JSON.parse(retVal);\n}","funcProperties":{"__isSmartRef__":true,"id":154},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"153":{"this":{"__isSmartRef__":true,"id":0}},"154":{"timestamp":{"__isSmartRef__":true,"id":155}},"155":{"isSerializedDate":true,"string":"Mon Nov 14 2011 17:41:51 GMT-0800 (PST)"},"156":{"varMapping":{"__isSmartRef__":true,"id":157},"source":"function tableStructure(tableName) {\n    var fields = this.fetchAll(\"select sql from sqlite_master where name like '\" + tableName + \"'\");\n    var res = [];\n\n    fields = fields[0]['sql'];\n    fields = fields.match(/\\((.*)\\)$/)[1];\n    fields = fields.split(',');\n    fields.forEach(function (ea) {\n        var pair = ea.trim().split(' ');\n        res.push({name: pair[0], type: pair[1]});\n    });\n    return res;\n}","funcProperties":{"__isSmartRef__":true,"id":158},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"157":{"this":{"__isSmartRef__":true,"id":0}},"158":{"timestamp":{"__isSmartRef__":true,"id":159},"categories":["metadata"]},"159":{"isSerializedDate":true,"string":"Mon Nov 21 2011 09:51:54 GMT-0800 (PST)"},"160":{"varMapping":{"__isSmartRef__":true,"id":161},"source":"function createTableForForm(dataForm) {\n  \n    var cmd = 'create table ' + dataForm.getTableName() + ' (';\n    dataForm.submorphs.forEach(function (each) {\n        if (each.isTypedDataField) \n            cmd += each.getName() + ' ' + each.getType() + ', ';\n    });\n    cmd = cmd.substring(0, cmd.length - 2); // removes last ', '\n    cmd += ')';\n    this.exec(cmd);\n\n    dataForm.submorphs.forEach(function (dataField) {\n        if (!dataField.isDataField) return;\n        var metadataEntry = {\n            tableName: dataForm.getTableName(),\n            columnName: dataField.getName(),\n            type: dataField.getType(),\n            selector: (dataField.getSelectorString ? dataField.getSelectorString() : null),\n            partName: (dataField.partsBinMetaInfo ? dataField.partsBinMetaInfo.partName : null)\n        }\n        this.saveObject('metadata', metadataEntry);\n    }.bind(this));\n    \n}","funcProperties":{"__isSmartRef__":true,"id":162},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"161":{"this":{"__isSmartRef__":true,"id":0}},"162":{"timestamp":{"__isSmartRef__":true,"id":163},"categories":[]},"163":{"isSerializedDate":true,"string":"Tue Nov 22 2011 15:21:25 GMT-0800 (PST)"},"164":{"varMapping":{"__isSmartRef__":true,"id":165},"source":"function saveObject(table, object) {\n    if (!object.rowid) {\n        this.insert(table, object);\n    } else {\n        this.update(table, object, ['rowid='+ object.rowid]);\n    }\n}","funcProperties":{"__isSmartRef__":true,"id":166},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"165":{"this":{"__isSmartRef__":true,"id":0}},"166":{"timestamp":{"__isSmartRef__":true,"id":167},"categories":[]},"167":{"isSerializedDate":true,"string":"Tue Nov 22 2011 14:52:00 GMT-0800 (PST)"},"168":{"varMapping":{"__isSmartRef__":true,"id":169},"source":"function tableExists(aTableName) {\n    return this.fetchAll(\n        \"SELECT * from sqlite_master WHERE name = '\" +\n        aTableName + \"' AND type = 'table' \").\n            length > 0;\n}","funcProperties":{"__isSmartRef__":true,"id":170},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"169":{"this":{"__isSmartRef__":true,"id":0}},"170":{"timestamp":{"__isSmartRef__":true,"id":171},"categories":[]},"171":{"isSerializedDate":true,"string":"Tue Nov 22 2011 15:34:53 GMT-0800 (PST)"},"172":{"varMapping":{"__isSmartRef__":true,"id":173},"source":"function updateCol(tableName, colName, rowid, newValue) {\n    var res = this.createResource();\n    var newValueString = escape(JSON.stringify(newValue));\n\n    var funcString = 'function(res) { ' + \n        'db.query(\"update ' + \n            tableName + ' set ' + colName + '=\" + ' +\n            'JSON.parse(unescape(\"' + newValueString + \n                '\")) + \" where rowid = ' + rowid + '\", null, ' + \n                'function(err) { ' +\n                    'res.send(JSON.stringify({error: err}));' +\n                '}' + \n        ');}';\n    //alert(funcString);\n    return JSON.parse(res.post(funcString).content);\n}","funcProperties":{"__isSmartRef__":true,"id":174},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"173":{"this":{"__isSmartRef__":true,"id":0}},"174":{"timestamp":{"__isSmartRef__":true,"id":175},"categories":[]},"175":{"isSerializedDate":true,"string":"Wed Nov 23 2011 08:25:00 GMT-0800 (PST)"},"176":{"varMapping":{"__isSmartRef__":true,"id":177},"source":"function createMetadataTables() {\n    this.exec(\"create table metadata (tableName text, columnName text, type text, selector text, partName text)\");\n    this.exec(\"create table metadata_forms (tableName text, userRights integer, form blob)\"); \n}","funcProperties":{"__isSmartRef__":true,"id":178},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"177":{"this":{"__isSmartRef__":true,"id":0}},"178":{"timestamp":{"__isSmartRef__":true,"id":179},"tags":[]},"179":{"isSerializedDate":true,"string":"Wed Jan 04 2012 14:26:26 GMT-0800 (PST)"},"180":{"varMapping":{"__isSmartRef__":true,"id":181},"source":"function ensureFormIsPresent(table, form) {\n    var forms = this.fetchAll(\"select * from metadata_forms where tableName like '\" + table + \"'\");\n    \n    if (forms.length == 0) {\n        this.insert('metadata_forms', {\n            tableName: table, \n            userRights: 0, // default\n            form: form\n        });\n    }\n}","funcProperties":{"__isSmartRef__":true,"id":182},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"181":{"this":{"__isSmartRef__":true,"id":0}},"182":{"timestamp":{"__isSmartRef__":true,"id":183},"categories":[]},"183":{"isSerializedDate":true,"string":"Wed Nov 23 2011 11:56:34 GMT-0800 (PST)"},"184":{"varMapping":{"__isSmartRef__":true,"id":185},"source":"function fetchFormForTable(tableName) {\n    var forms = this.fetchAll(\"select form from metadata_forms where tableName like '\" + tableName + \"'\");\n    if (!forms || !forms.length || forms.length < 1) {\n        return null;\n    }\n    return lively.persistence.Serializer.deserialize(forms[0].form);\n}","funcProperties":{"__isSmartRef__":true,"id":186},"__SourceModuleName__":"Global","__LivelyClassName__":"lively.Closure"},"185":{"this":{"__isSmartRef__":true,"id":0}},"186":{"timestamp":{"__isSmartRef__":true,"id":187},"categories":[]},"187":{"isSerializedDate":true,"string":"Wed Nov 23 2011 12:46:15 GMT-0800 (PST)"},"isSimplifiedRegistry":true}}