{"id":0,"registry":{"0":{"submorphs":[],"scripts":[],"id":"773644AD-8BF3-4BB5-B872-DC66D26F3F74","shape":{"__isSmartRef__":true,"id":1},"grabbingEnabled":false,"droppingEnabled":false,"halosEnabled":true,"fixedWidth":true,"fixedHeight":false,"allowsInput":true,"_FontFamily":"Arial, sans-serif","registeredForMouseEvents":true,"_MaxTextWidth":120.695652,"_MaxTextHeight":null,"showsHalos":false,"_FontSize":14,"name":"ReferenceTextExample","partsBinMetaInfo":{"__isSmartRef__":true,"id":2},"textChunks":[{"__isSmartRef__":true,"id":18},{"__isSmartRef__":true,"id":20},{"__isSmartRef__":true,"id":22},{"__isSmartRef__":true,"id":25}],"charsReplaced":"","lastFindLoc":76,"prevScroll":[0,0],"eventHandler":{"__isSmartRef__":true,"id":27},"_ClipMode":"visible","derivationIds":[355,"1EB1674F-8BF2-419B-B054-86129ED70335","63698904-DC05-4341-A9B6-5CC4A219CD04","F6A714BA-4735-41ED-8A2A-45CB153FBDF8","6706720E-D013-4F22-BFD9-250CF3CD1F3F..."],"_WhiteSpaceHandling":"pre-wrap","_MinTextWidth":120.695652,"_MinTextHeight":null,"isBeingDragged":false,"moved":true,"_Rotation":0,"_Scale":1,"savedTextString":"Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some \nText Some Text Some Text Some Text Some Text \nSome Text thesis://excerpts/EnyoJS2013.xhtml  Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text ","currentLink":"Sennet2008C","__serializedExpressions__":["_Position","textColor","_Padding","distanceToDragEvent"],"lastSearchString":"","lastSearchIndex":0,"searchHighlights":[],"__serializedLivelyClosures__":{"__isSmartRef__":true,"id":28},"__LivelyClassName__":"lively.morphic.Text","__SourceModuleName__":"Global.lively.morphic.TextCore","_Position":"lively.pt(0.0,0.0)","textColor":"Color.rgb(0,0,0)","_Padding":"lively.rect(5,5,0,0)","distanceToDragEvent":"lively.pt(386.0,-14.0)"},"1":{"fill":null,"_BorderWidth":0,"_ClipMode":"visible","_BorderRadius":0,"_Opacity":1,"_BorderStyle":"solid","_AppearanceStylingMode":false,"_BorderStylingMode":false,"__serializedExpressions__":["_Fill","_Position","_Extent","_BorderColor","_Padding"],"__LivelyClassName__":"lively.morphic.Shapes.Rectangle","__SourceModuleName__":"Global.lively.morphic.Shapes","_Fill":"Color.rgb(254,255,186)","_Position":"lively.pt(0.0,0.0)","_Extent":"lively.pt(543.7,177.0)","_BorderColor":"Color.rgb(0,0,0)","_Padding":"lively.rect(0,0,0,0)"},"2":{"partsSpaceName":"PartsBin/Jens","migrationLevel":4,"comment":"a prototype for implementing text references","partName":"ReferenceTextExample","changes":[{"__isSmartRef__":true,"id":3},{"__isSmartRef__":true,"id":5},{"__isSmartRef__":true,"id":7},{"__isSmartRef__":true,"id":9},{"__isSmartRef__":true,"id":11},{"__isSmartRef__":true,"id":13},{"__isSmartRef__":true,"id":15}],"revisionOnLoad":193018,"lastModifiedDate":{"__isSmartRef__":true,"id":17},"__LivelyClassName__":"lively.PartsBin.PartsBinMetaInfo","__SourceModuleName__":"Global.lively.PartsBin"},"3":{"date":{"__isSmartRef__":true,"id":4},"author":"robertkrahn","message":"text click was broken?","id":"9D065E14-9653-4B2A-9A2E-3AD84EBBC3E0"},"4":{"isSerializedDate":true,"string":"Sat Apr 21 2012 16:30:30 GMT+0200 (CEST)"},"5":{"date":{"__isSmartRef__":true,"id":6},"author":"undefined","message":"Set the inset as: this.setPadding(Rectangle.inset(4,2)).  This gives it a more pleasing appearance with a border, and also makes it easier to select near the bounds.","id":"BD5B0E4C-4830-4863-A013-35BB66D5AD6F"},"6":{"isSerializedDate":true,"string":"Mon Feb 27 2012 06:20:38 GMT+0100 (CET)"},"7":{"date":{"__isSmartRef__":true,"id":8},"author":"tessi","message":"TextBubble calls its disappear() function after showBubbleTime() milliseconds now","id":"0F4DE333-A551-4961-B29D-70270977EBEF"},"8":{"isSerializedDate":true,"string":"Sat Apr 21 2012 07:31:43 GMT+0200 (CEST)"},"9":{"date":{"__isSmartRef__":true,"id":10},"author":"tessi","message":"TextBubble calls its disappear() function after showBubbleTime() milliseconds now","id":"785D95BD-7858-43EB-90E6-A1C085E2F2B9"},"10":{"isSerializedDate":true,"string":"Sat Apr 21 2012 07:32:09 GMT+0200 (CEST)"},"11":{"date":{"__isSmartRef__":true,"id":12},"author":"timfelgentreff","message":"better text","id":"B904F9AC-6EA0-4A8A-83C9-AFC85AADC194"},"12":{"isSerializedDate":true,"string":"Tue May 08 2012 14:18:18 GMT+0200 (CEST)"},"13":{"date":{"__isSmartRef__":true,"id":14},"author":"jenslincke","message":"no comment","id":"720D5B93-220F-4507-BB9F-9DF47B99BFFD"},"14":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:38:36 GMT+0100 (CET)"},"15":{"date":{"__isSmartRef__":true,"id":16},"author":"jenslincke","message":"no comment","id":"546DACE7-EE70-4B23-A80B-9B8DD1C5DB1C"},"16":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:55:36 GMT+0100 (CET)"},"17":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:38:05 GMT+0100 (CET)"},"18":{"_id":"_465717","style":{"__isSmartRef__":true,"id":19},"chunkOwner":{"__isSmartRef__":true,"id":0},"storedString":"","__LivelyClassName__":"lively.morphic.TextChunk","__SourceModuleName__":"Global.lively.morphic.TextCore"},"19":{"color":"rgb(0,0,0)","fontFamily":"Arial,sans-serif","fontSize":"18.88888931274414px","fontWeight":"normal","textAlign":"start","backgroundColor":"rgb(255,255,255)","__LivelyClassName__":"lively.morphic.TextEmphasis","__SourceModuleName__":"Global.lively.morphic.TextCore"},"20":{"_id":"_542169","style":{"__isSmartRef__":true,"id":21},"chunkOwner":{"__isSmartRef__":true,"id":0},"storedString":"Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some [","__LivelyClassName__":"lively.morphic.TextChunk","__SourceModuleName__":"Global.lively.morphic.TextCore"},"21":{"__LivelyClassName__":"lively.morphic.TextEmphasis","__SourceModuleName__":"Global.lively.morphic.TextCore"},"22":{"_id":"_1575","style":{"__isSmartRef__":true,"id":23},"chunkOwner":{"__isSmartRef__":true,"id":0},"storedString":"Sennet2008C","__LivelyClassName__":"lively.morphic.TextChunk","__SourceModuleName__":"Global.lively.morphic.TextCore"},"23":{"data":{"__isSmartRef__":true,"id":24},"__LivelyClassName__":"lively.morphic.TextEmphasis","__SourceModuleName__":"Global.lively.morphic.TextCore"},"24":{"type":"reference"},"25":{"_id":"_1576","style":{"__isSmartRef__":true,"id":26},"chunkOwner":{"__isSmartRef__":true,"id":0},"storedString":"]\n\nText Some Text Some Text Some Text Some Text \nSome   Text Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text Some Text ","__LivelyClassName__":"lively.morphic.TextChunk","__SourceModuleName__":"Global.lively.morphic.TextCore"},"26":{"__LivelyClassName__":"lively.morphic.TextEmphasis","__SourceModuleName__":"Global.lively.morphic.TextCore"},"27":{"morph":{"__isSmartRef__":true,"id":0},"__LivelyClassName__":"lively.morphic.EventHandler","__SourceModuleName__":"Global.lively.morphic.Events"},"28":{"textChunkAtPoint":{"__isSmartRef__":true,"id":29},"onMouseMove":{"__isSmartRef__":true,"id":33},"showClientRect":{"__isSmartRef__":true,"id":41},"showLinkButtons":{"__isSmartRef__":true,"id":45},"clientRectToGlobalBounds":{"__isSmartRef__":true,"id":49},"onMouseOver":{"__isSmartRef__":true,"id":53},"referenceHaloContainPoint":{"__isSmartRef__":true,"id":57},"referenceRegex":{"__isSmartRef__":true,"id":61},"createReferenceTextChunks":{"__isSmartRef__":true,"id":65},"hideReferenceHalo":{"__isSmartRef__":true,"id":69},"hideReferenceHaloDelayed":{"__isSmartRef__":true,"id":73},"showReferenceHaloDelayed":{"__isSmartRef__":true,"id":77}},"29":{"varMapping":{"__isSmartRef__":true,"id":30},"source":"function textChunkAtPoint(p) {\n    return this.textChunks\n        .select(function(ea) { return ea.style.data && ea.style.data.type == 'reference' })\n        .detect(function(ea) {\n        var r = ea.chunkNode.getBoundingClientRect()\n        return p.x > r.left && p.x < r.right\n            && p.y > r.top && p.y < r.bottom\n    })\n}","funcProperties":{"__isSmartRef__":true,"id":31},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"30":{"this":{"__isSmartRef__":true,"id":0}},"31":{"timestamp":{"__isSmartRef__":true,"id":32},"user":"jenslincke","tags":[]},"32":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:37:04 GMT+0100 (CET)"},"33":{"varMapping":{"__isSmartRef__":true,"id":34},"source":"function onMouseMove(evt) {\n    var c = this.textChunkAtPoint(evt.getPosition().subPt(this.world().getScrollOffset()))\n    var hand = evt.hand;\n    if (this.lastShowRect) this.lastShowRect.remove()\n    if (c && c.textString.match(this.referenceRegex())) {\n        var clientRect = c.chunkNode.getBoundingClientRect();\n        this.lastShowRect = this.showClientRect(clientRect)\n        var globalBounds = this.clientRectToGlobalBounds(clientRect)\n        this.showReferenceHaloDelayed(c.textString, hand, globalBounds)\n        this.hideReferenceHaloDelayed(hand, globalBounds)\n     }\n}","funcProperties":{"__isSmartRef__":true,"id":39},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"34":{"this":{"__isSmartRef__":true,"id":0},"__serializedLivelyClosures__":{"__isSmartRef__":true,"id":35}},"35":{"$super":{"__isSmartRef__":true,"id":36}},"36":{"varMapping":{"__isSmartRef__":true,"id":37},"source":"function () {\n                    try {\n                        return obj.constructor.prototype[name].apply(obj, arguments)\n                    } catch (e) {\n                        if ($world)\n                            $world.logError(e, 'Error in $super call')\n                        else\n                            alert('Error in $super call: ' + e + '\\n' + e.stack);\n                        return null;\n                    }\n                }","funcProperties":{"__isSmartRef__":true,"id":38},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"37":{"obj":{"__isSmartRef__":true,"id":0},"name":"onMouseMove"},"38":{},"39":{"timestamp":{"__isSmartRef__":true,"id":40},"user":"jenslincke","tags":[]},"40":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:54:16 GMT+0100 (CET)"},"41":{"varMapping":{"__isSmartRef__":true,"id":42},"source":"function showClientRect(r) {\n    var b = this.clientRectToGlobalBounds(r)\n    var m = showRect(b, 5)\n    m.isEpiMorph = true\n    m.disableEvents()\n    m.setBorderColor(Color.blue)\n    m.setBorderWidth(5)\n    return m\n}","funcProperties":{"__isSmartRef__":true,"id":43},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"42":{"this":{"__isSmartRef__":true,"id":0}},"43":{"timestamp":{"__isSmartRef__":true,"id":44},"user":"jenslincke","tags":[]},"44":{"isSerializedDate":true,"string":"Wed Feb 27 2013 15:36:46 GMT+0100 (CET)"},"45":{"varMapping":{"__isSmartRef__":true,"id":46},"source":"function showLinkButtons(linkString, globalBounds) {\n    this.hideReferenceHalo()\n    this.referenceHalo = this.world().openPartItem(\"ReferenceHalo\", \"PartsBin/Jens\")\n    this.referenceHalo.isEpiMorph = true;\n    this.world().addMorph(this.referenceHalo)\n    this.referenceHalo.align(\n        this.referenceHalo.bounds().bottomRight(),\n        globalBounds.topRight())\n    this.referenceHalo.reference =  linkString;\n}","funcProperties":{"__isSmartRef__":true,"id":47},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"46":{"this":{"__isSmartRef__":true,"id":0}},"47":{"timestamp":{"__isSmartRef__":true,"id":48},"user":"jenslincke","tags":[]},"48":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:51:54 GMT+0100 (CET)"},"49":{"varMapping":{"__isSmartRef__":true,"id":50},"source":"function clientRectToGlobalBounds(r) {\n    var scroll = $world.getScrollOffset().subPt($world.getPosition())\n    return new Rectangle(r.left + scroll.x, r.top + scroll.y, r.width, r.height)\n}","funcProperties":{"__isSmartRef__":true,"id":51},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"50":{"this":{"__isSmartRef__":true,"id":0}},"51":{"timestamp":{"__isSmartRef__":true,"id":52},"user":"jenslincke","tags":[]},"52":{"isSerializedDate":true,"string":"Thu Feb 28 2013 17:45:52 GMT+0100 (CET)"},"53":{"varMapping":{"__isSmartRef__":true,"id":54},"source":"function onMouseOver() {\n    this.createReferenceTextChunks()\n}","funcProperties":{"__isSmartRef__":true,"id":55},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"54":{"this":{"__isSmartRef__":true,"id":0}},"55":{"timestamp":{"__isSmartRef__":true,"id":56},"user":"jenslincke","tags":[]},"56":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:42:04 GMT+0100 (CET)"},"57":{"varMapping":{"__isSmartRef__":true,"id":58},"source":"function referenceHaloContainPoint(p) {\n    if (!this.referenceHalo) return false;\n    return this.referenceHalo.bounds().containsPoint(p)\n}","funcProperties":{"__isSmartRef__":true,"id":59},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"58":{"this":{"__isSmartRef__":true,"id":0}},"59":{"timestamp":{"__isSmartRef__":true,"id":60},"user":"jenslincke","tags":[]},"60":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:53:15 GMT+0100 (CET)"},"61":{"varMapping":{"__isSmartRef__":true,"id":62},"source":"function referenceRegex() {\n    return /[A-Za-z]+[1-2][0-9][0-9][0-9][A-Z][A-Z]?[A-Z]?/g\n}","funcProperties":{"__isSmartRef__":true,"id":63},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"62":{"this":{"__isSmartRef__":true,"id":0}},"63":{"timestamp":{"__isSmartRef__":true,"id":64},"user":"jenslincke","tags":[]},"64":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:40:59 GMT+0100 (CET)"},"65":{"varMapping":{"__isSmartRef__":true,"id":66},"source":"function createReferenceTextChunks() {\n    this.emphasizeRegex(this.referenceRegex(), {data: {type: 'reference'}})\n}","funcProperties":{"__isSmartRef__":true,"id":67},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"66":{"this":{"__isSmartRef__":true,"id":0}},"67":{"timestamp":{"__isSmartRef__":true,"id":68},"user":"jenslincke","tags":[]},"68":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:41:55 GMT+0100 (CET)"},"69":{"varMapping":{"__isSmartRef__":true,"id":70},"source":"function hideReferenceHalo() {\n      if (this.referenceHalo) {\n          this.referenceHalo.remove();\n          delete this.referenceHalo\n      }\n}","funcProperties":{"__isSmartRef__":true,"id":71},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"70":{"this":{"__isSmartRef__":true,"id":0}},"71":{"timestamp":{"__isSmartRef__":true,"id":72},"user":"jenslincke","tags":[]},"72":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:46:37 GMT+0100 (CET)"},"73":{"varMapping":{"__isSmartRef__":true,"id":74},"source":"function hideReferenceHaloDelayed(hand, globalBounds) {\n    var hideIfMouseChanged = function() {\n        var p = hand.getPosition();\n        if (! globalBounds.containsPoint(p) && !this.referenceHaloContainPoint(p)) {\n            this.hideReferenceHalo()\n        } else {\n            hideIfMouseChanged.delay(1)\n        }\n    }.bind(this)\n    hideIfMouseChanged.delay(4)\n}","funcProperties":{"__isSmartRef__":true,"id":75},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"74":{"this":{"__isSmartRef__":true,"id":0}},"75":{"timestamp":{"__isSmartRef__":true,"id":76},"user":"jenslincke","tags":[]},"76":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:46:46 GMT+0100 (CET)"},"77":{"varMapping":{"__isSmartRef__":true,"id":78},"source":"function showReferenceHaloDelayed(referenceString, hand, globalBounds) {\n    var showDelayed = function() {\n        if (globalBounds.containsPoint(hand.getPosition())) {\n            this.showLinkButtons(referenceString, globalBounds);\n        }\n    }.bind(this).delay(2)\n}","funcProperties":{"__isSmartRef__":true,"id":79},"__LivelyClassName__":"lively.Closure","__SourceModuleName__":"Global.lively.lang.Closure"},"78":{"this":{"__isSmartRef__":true,"id":0}},"79":{"timestamp":{"__isSmartRef__":true,"id":80},"user":"jenslincke","tags":[]},"80":{"isSerializedDate":true,"string":"Tue Mar 05 2013 11:55:11 GMT+0100 (CET)"},"isSimplifiedRegistry":true}}